{"mappings":"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","sources":["src/index.js","src/js/loadPage.js","src/js/visitEvents.js","src/js/lazy-loading.js"],"sourcesContent":["import './js/common';\nimport './js/fetchMovies';\nimport './js/arrowUp';\nimport './js/loadPage';\nimport './js/pageInStorage';\nimport './js/modal';\nimport './js/pagination';\nimport './js/modalFooter';\nimport './js/storage';\nimport './js/visitEvents';\nimport './js/lazy-loading';\n\n","import storage from './storage';\nimport { currentPage, defineResultsPerPage } from './pagination';\n\n\nconst KEY = '659c146febfafc17fd54baa17527f7fa';\nconst homeList = document.querySelector('.home-list');\n\nconst API_URL_POPULAR = `https://api.themoviedb.org/3/trending/movie/week?api_key=${KEY}`;\n\n\nasync function fetchFilms(API_URL_POPULAR) {\n\n  let response = await fetch(\n    `${API_URL_POPULAR}`\n  );\n  return response.json();\n}\n\nasync function fetchGenres() {\n  let response = await fetch(\n    `https://api.themoviedb.org/3/genre/movie/list?api_key=${KEY}&language=en-US`\n  );\n  return response.json();\n}\n\nfetchGenres().then(({ genres }) => {\n  const arr = [...genres];\n  localStorage.setItem('arrow', JSON.stringify(arr));\n});\nconst values = storage.load('arrow');\n\n\n  fetchFilms(API_URL_POPULAR).then(({ results }) => {\n\n  results.poster_path;\n\n\n  const mark = results\n    .map(\n      ({\n        id,\n        poster_path,\n        title,\n        original_title,\n        genre_ids,\n        release_date,\n        original_name,\n        first_air_date,\n      }) => {\n        const genreArr = [];\n        let other = '';\n        for (const genreId of genre_ids) {\n          for (const value of values) {\n            if (genreId === value.id) {\n              genreArr.push(value.name);\n              if (genre_ids.length > 2) {\n                other = ',Other';\n              }\n            }\n          }\n        }\n\n        let a = release_date;\n\n        let b = first_air_date;\n        if (release_date) {\n          a = a.slice(0, 4);\n        }\n        if (first_air_date) {\n          b = b.slice(0, 4);\n        }\n\n        const imgUrl = `https://image.tmdb.org/t/p/w500${poster_path}`;\n        return `<li class=\"home-card js-modal-open placeholdify\" data-card-movie-id=\"${id}\">\n            <a href=\"#\" class=\"home-card__link\">\n                <div class=\"card-info\">\n                    <img class=\"home-card__img\" src=\"${imgUrl}\" alt=\"${title}\">\n                    <h2 class=\"card-info__title\">${original_title || original_name}</h2>\n                    <p class=\"card-info_descr\">\n                        <span>${genreArr.splice(0, 3)}  ${other}</span>\n                        \n                        |\n                        <span>${a || b}</span>\n                    </p>\n                </div>\n            </a>\n        </li>`;\n      }\n  )\n    \n      .join('');\n     setTimeout(() => {\n      const arr = document.querySelectorAll('.placeholdify');\n      arr.forEach(el => el.classList.remove('placeholdify'));\n      },2000);\n  storage.save('movies', results);\n    homeList.insertAdjacentHTML('beforeend', mark);\n});\n\nexport default fetchFilms();\n\n","import { storagePage } from './pageInStorage';\nimport * as page from './pagination';\nimport { loadStoragePage } from './fetchMovies';\n\n\n export const refs = {\n    comeBackBtn: document.querySelector('button.js-visit-back-btn'),\n    visitModal: document.querySelector(\"[data-modal].dialog\"),   \n    visitCloseBtn: document.querySelector(\"button.js-visit-close-btn\"),\n};\n    refs.comeBackBtn.addEventListener(\"click\", comeBackBtnToggle); \n    refs.visitCloseBtn.addEventListener(\"click\", toggleModal);\n    \n    \nlet timerId;\n(() => {\n    if (page.currentPage == 1 || storagePage?.value === undefined) {\n        return \n    } else {        \n        toggleModal();\n        return  timerId = setTimeout(() => { toggleModal() }, 15000);      \n    }\n})();    \n\n\nfunction toggleModal() {   \n    refs.visitModal.classList.toggle(\"is-hidden\");     \n    \n    if (refs.visitModal.classList.value.includes(\"hidden\") === true) {\n           clearTimeout(timerId);  \n        refs.comeBackBtn.removeEventListener(\"click\", comeBackBtnToggle);        \n        refs.visitCloseBtn.removeEventListener(\"click\", toggleModal);\n    };\n};\n\n function comeBackBtnToggle() {   \n    refs.visitModal.classList.toggle(\"is-hidden\");     \n    loadStoragePage()\n    if (refs.visitModal.classList.value.includes(\"hidden\") === true) {\n           clearTimeout(timerId);  \n        refs.comeBackBtn.removeEventListener(\"click\", comeBackBtnToggle);        \n        refs.visitCloseBtn.removeEventListener(\"click\", toggleModal);\n    };\n};\n","// import loadPage from './loadPage';\n// import { fetchFilms } from './loadPage';\n\n// 1. Для кожного зображення додати loading='lazy'\n// 2. Для того, щоб працювало в усіх браузерах, потрібна бібліотека lazysizes(знайти на git hub)\n// можна використати CDN lazysizes.min.js  , додати скрипт динамічно\n// - додати всім зображенням class='lazyload'\n// - src замінити на data-src\n// 3. видаляємо слухача за допомогою 'once'(підтримується майже всіма браузерами), додається в опції. Після того як\n// addEventListener спрацює один раз, він самовидалиться\n\n\n// Feature detection\nif ('loading' in HTMLImageElement.prototype) {\n    console.log('Браузер підтримує lazyload');\n    const lazyImages = document.querySelectorAll('image[loading=\"lazy\"]');\n    lazyImages.forEach(image => {\n        image.src = image.dataset.src;\n    });\n// supported in browser\n} else {\n    console.log('Браузер не підтримує lazyload');\n    const script = document.createElement('script');\n    script.src = 'https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.3.2/lazysizes.min.js';\n    script.integrity = 'sha512-q583ppKrCRc7N5O0n2nzUiJ+suUv7Et1JGels4bXOaMFQcamPk9HjdUknZuuFjBNs7tsMuadge5k9RzdmO+1GQ==';\n    script.crossOrigin = 'anonymous';\n    script.referrerpolicy = 'no-referrer';\n    document.body.appendChild(script);\n// fetch polyfill/third-party library\n}\n\nconst lazyImages = document.querySelectorAll('image[data-src]');\n    console.log(lazyImages);\n\n    lazyImages.forEach(image => {\n    image.addEventListener('load', onImageLoaded, { once: true });\n});\n\nfunction onImageLoaded(event) {\n    console.log(\"Зображення завантажилось\");\n// можна додати класс, анімацію і тд\n// event.target.classList.add();\n}"],"names":["parcelRequire","$5uEKZ","$8a393290a593310b$var$homeList","document","querySelector","async","$8a393290a593310b$var$fetchFilms","API_URL_POPULAR1","fetch","json","$8a393290a593310b$var$fetchGenres","then","genres","arr","localStorage","setItem","JSON","stringify","$8a393290a593310b$var$values","default","load","results","poster_path","mark","map","id","title","original_title","genre_ids","release_date","original_name","first_air_date","genreArr","other","genreId","value","push","name","length","a","b","slice","splice","join","setTimeout","querySelectorAll","forEach","el","classList","remove","save","insertAdjacentHTML","$ijW3m","$ffef372a5b1a0ba3$export$21666b427502ea6d","comeBackBtn","visitModal","visitCloseBtn","$ffef372a5b1a0ba3$var$timerId","$ffef372a5b1a0ba3$var$toggleModal","toggle","includes","clearTimeout","removeEventListener","$ffef372a5b1a0ba3$var$comeBackBtnToggle","$1TPJ0","loadStoragePage","addEventListener","$2nhTy","currentPage","undefined","storagePage","HTMLImageElement","prototype","console","log","image","src","dataset","script","createElement","integrity","crossOrigin","referrerpolicy","body","appendChild","$ead53d6c8d8f066c$var$lazyImages","$ead53d6c8d8f066c$var$onImageLoaded","event","once"],"version":3,"file":"index.2c579b47.js.map"}