{"mappings":"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","sources":["src/js/storage.js","src/js/fetchMovies.js","src/js/loadPage.js","src/js/pageInStorage.js","src/js/modal.js"],"sourcesContent":["const save = (key, value) => {\n  try {\n    const serializedState = JSON.stringify(value);\n    localStorage.setItem(key, serializedState);\n  } catch (error) {\n    console.error(\"Set state error: \", error.message);\n  }\n};\n\nconst load = key => {\n  try {\n    const serializedState = localStorage.getItem(key);\n    return serializedState === null ? undefined : JSON.parse(serializedState);\n  } catch (error) {\n    console.error(\"Get state error: \", error.message);\n  }\n};\n\nconst remove = key => {\n    try { \n      if (localStorage.getItem(key) !== null) { localStorage.removeItem(key); }\n    } catch (error) {\n        console.error(\"Remove state error: \", error.message);\n    }\n};\n\nexport default {\n  save,\n  load,\n  remove,\n};\n","import storage from './storage'\n\nconst formField = document.querySelector('.form-field');\nconst homeList = document.querySelector('.home-list');\nconst spinner = document.querySelector('.spinner-loader');\nlet movieName = '';\n\nformField.addEventListener('submit', event => {\n  event.preventDefault();\n  spinner.classList.remove('is-hidden');\n  movieName = formField.elements.query.value.trim();\n  if (movieName === '') {\n    spinner.classList.add('is-hidden');\n    return alert('Empty field');\n  }\n  fetchMovies(movieName).then(({ movies }) => {\n    storage.save('movies', movies);\n    homeList.innerHTML = movieCards(movies);\n    spinner.classList.add('is-hidden');\n  });\n});\n\n\nexport function movieCards (movies) {\n  return movies\n    .map(({ id, poster_path, title, original_title, genres_ids, release_date }) => {\n        const imgUrl = `https://image.tmdb.org/t/p/w500${poster_path}`;\n        return `<li class=\"home-card js-modal-open\" data-card-movie-id=\"${id}\">\n            <a href=\"#\" class=\"home-card__link\">\n                <div class=\"card-info\">\n                    <img class=\"home-card__img\" src=\"${imgUrl}\" alt=\"${title}\">\n                    <h2 class=\"card-info__title\">${original_title}</h2>\n                    <p class=\"card-info_descr\">\n                        <span>${genres_ids}</span>\n                        |\n                        <span>${release_date}</span>\n                    </p>\n                </div>\n            </a>\n        </li>`;\n    })\n    .join('');\n};\n\nfunction fetchMovies (movieName){\n  const searchParams = new URLSearchParams({\n    api_key: '659c146febfafc17fd54baa17527f7fa',\n    language: 'en-US',\n    query: movieName,\n  });\n\n  return fetch(`https://api.themoviedb.org/3/search/movie?${searchParams}`)\n    .then(res => {\n      if (res.ok) {\n        return res.json();\n      }\n      throw new Error(res.statusText);\n    })\n    .then(data => {\n      return {\n        movies: data.results\n      };\n    });\n};","import storage from './storage'\n\nconst KEY = '659c146febfafc17fd54baa17527f7fa';\nconst MEDIA_TYPE = 'movie';\nconst TIME_WINDOW = 'week';\nasync function fetchFilms(KEY, MEDIA_TYPE, TIME_WINDOW) {\n  let response = await fetch(\n    `https://api.themoviedb.org/3/trending/all/day?api_key=${KEY}&media_type=${MEDIA_TYPE}&time_window=${TIME_WINDOW}`\n  );\n  return response.json();\n}\nfetchFilms(KEY, MEDIA_TYPE, TIME_WINDOW).then(({ results }) => {\n  // console.dir(results);\n  storage.save('movies', results);\n});\n","import storage from './storage'\n\nconst STORAGE_PAGE_KEY = \"Start on last visit page?\";\nconst storagePage = storage.load(STORAGE_PAGE_KEY)\n\nfunction changeStoragePage() {\n    if (page > 1 && page !== storagePage.value) {        \n        storage.remove(STORAGE_PAGE_KEY);\n        storage.save(STORAGE_PAGE_KEY, { value: page });\n    }    \n}\nfunction loadStoragePage() { \n    page = storagePage.value\n}\n","import storage from './storage';\n\nconst backdrop = document.querySelector('[data-modal]');\nconst closeButton = document.querySelector('[data-modal-close]');\nconst cardsContainer = document.querySelector('.home-container');\n\ncardsContainer.addEventListener('click', e => {\n  //Тиць по 'js-modal-open' -> відкриває модалку\n  if (e.target.closest('.js-modal-open'))\n    openModal(e.target.closest('.js-modal-open').dataset.cardMovieId);\n});\n\n// Тиць по 'data-modal-close' ->закриває модалку\ncloseButton.addEventListener('click', closeModal);\n\n//Press по Esc ->закриває модалку\nfunction pressEsc(e) {\n  if (e.code === 'Escape') {\n    closeModal();\n  }\n}\n\n// Тиць по backdrop -> закриває модалку\nbackdrop.addEventListener('click', backdropClick);\n\nfunction backdropClick(e) {\n  if (e.currentTarget === e.target) {\n    closeModal();\n    return;\n  }\n  if (e.target.nodeName === 'BUTTON') {\n    addMovieToLibrary(e.target);\n  }\n}\n\n// Якщо модалка відкрита -> кидаємо AddEventListener\nfunction openModal(movieId) {\n  document.addEventListener('keydown', pressEsc);\n\n  backdrop.querySelector('.modal-movie').dataset.modalMovieId = movieId;\n  backdrop.querySelector('.modal-movie').innerHTML = getModalMovieMarkup(movieId);\n  backdrop.classList.remove('is-hidden');\n}\n\n// Як тільки закривається модалка -> знімаємо EventListener\nfunction closeModal() {\n  document.addEventListener('keydown', pressEsc);\n  backdrop.classList.add('is-hidden');\n}\n\nfunction getModalMovieMarkup(movieId) {\n  const {\n    poster_path,\n    title,\n    original_title,\n    genres_ids,\n    release_date,\n    vote_average,\n    vote_count,\n    popularity,\n    overview,\n  } = storage.load('movies')?.find(movie => movie.id.toString() === movieId);\n\n  return `<img class=\"modal-movie__poster\" src='https://image.tmdb.org/t/p/w500${poster_path}' alt=\"${title}\" />\n            <div class=\"modal-movie__info\">\n                <h2 class=\"modal-movie__title\">${title}</h2>\n                <table class=\"movie-table\">\n                    <tr>\n                        <td class=\"movie-table__title\">Vote / Votes</td>\n                        <td class=\"movie-table__info\">\n                            <span class=\"vote\">${vote_average}</span>\n                            <span>/</span>\n                            <span class=\"votes\">${vote_count}</span>\n                        </td>\n                    </tr>\n                    <tr>\n                        <td class=\"movie-table__title\">Popularity</td>\n                        <td class=\"movie-table__info\">${popularity}</td>\n                    </tr>\n                    <tr>\n                        <td class=\"movie-table__title\">Original Title</td>\n                        <td class=\"movie-table__info\">${original_title}</td>\n                    </tr>\n                    <tr>\n                        <td class=\"movie-table__title\">Genre</td>\n                        <td class=\"movie-table__info\">${genres_ids}</td>\n                    </tr>\n                </table>\n                <div class=\"modal-movie__about\">\n                    <p class=\"modal-movie__description\">ABOUT</p>\n                    <p class=\"modal-movie__text\">${overview}</p>\n                </div>\n                <div class=\"modal-movie__buttons\">\n                    <button class=\"modal-movie__watched\" data-modal-add-to=\"watched\">ADD TO<br>WATCHED</button>\n                    <button class=\"modal-movie__queue\" data-modal-add-to=\"queue\">ADD TO <br> QUEUE</button>\n                </div>\n            </div>`;\n}\n\n/* -----------------------\n\nModal buttons functionality\n\n----------------------- */\n\nfunction addMovieToLibrary(button) {\n  const key = button.dataset?.modalAddTo + '-list';\n  const movieId = button.closest('.modal-movie').dataset.modalMovieId;\n\n  const value = storage.load('movies')?.find(movie => movie.id.toString() === movieId);\n  // console.dir(value.id);\n\n  let currentList = storage.load(key) || [];\n  console.dir(currentList);\n\n  if (storage.load(key) && storage.load(key).some(movie => movie.id === value.id)) {\n    console.log('has');\n    currentList = currentList.filter(movie => movie.id.toString() != value.id);\n  } else {\n    console.log('add');\n    currentList.push(value);\n  }\n\n  storage.save(key, currentList);\n}\n"],"names":["$3fff5e8daf4b13a6$export$2e2bcd8739ae039","key","value","serializedState","JSON","stringify","localStorage","setItem","error","console","message","getItem","undefined","parse","removeItem","$16230cf6cab73dd4$var$formField","document","querySelector","$16230cf6cab73dd4$var$homeList","$16230cf6cab73dd4$var$spinner","$16230cf6cab73dd4$var$movieName","addEventListener","event","preventDefault","classList","remove","elements","query","trim","add","alert","movieName1","searchParams","URLSearchParams","api_key","language","fetch","then","res","ok","json","Error","statusText","data","movies","results","$16230cf6cab73dd4$var$fetchMovies","save","innerHTML","map","id","poster_path","title","original_title","genres_ids","release_date","join","$16230cf6cab73dd4$export$867842ca7ae981de","async","KEY1","MEDIA_TYPE1","TIME_WINDOW1","$8a393290a593310b$var$fetchFilms","load","$8a7e756c566dd1ea$var$backdrop","$8a7e756c566dd1ea$var$closeButton","$8a7e756c566dd1ea$var$pressEsc","e","code","$8a7e756c566dd1ea$var$closeModal","movieId","target","closest","dataset","cardMovieId","modalMovieId","ref","vote_average","vote_count","popularity","overview","find","movie","toString","$8a7e756c566dd1ea$var$getModalMovieMarkup","currentTarget","nodeName","button","ref1","modalAddTo","currentList","dir","some","log","filter","push","$8a7e756c566dd1ea$var$addMovieToLibrary"],"version":3,"file":"index.5c02acc2.js.map"}