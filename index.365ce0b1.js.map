{"mappings":"oeAAAA,EAAA,S,sBCAA,IAAAC,EAAAD,EAAA,SACA,MACME,EAAWC,SAASC,cAAc,eAYxCC,iBAIE,aAHqBC,MACnB,0GAEcC,QAGlBC,GAAcC,MAAK,EAACC,OAAEA,MACpB,MAAMC,EAAM,IAAID,GAChBE,aAAaC,QAAQ,QAASC,KAAKC,UAAUJ,OAE/C,MAAMK,EAASf,EAAAgB,QAAQC,KAAK,UAnB5Bb,eAA0Bc,GAKxB,aAHqBb,MACnB,GAAGa,MAEWZ,QAiBhBa,CAxBsB,6FAwBMX,MAAK,EAACY,QAAEA,MAEpCA,EAAQC,YAGR,MAAMC,EAAOF,EACVG,KACC,EAACC,GACCA,EAAEH,YACFA,EAAWI,MACXA,EAAKC,eACLA,EAAcC,UACdA,EAASC,aACTA,EAAYC,cACZA,EAAaC,eACbA,MAEA,MAAMC,EAAW,GACjB,IAAIC,EAAQ,GACZ,IAAK,MAAMC,KAAWN,EACpB,IAAK,MAAMO,KAASnB,EACdkB,IAAYC,EAAMV,KACpBO,EAASI,KAAKD,EAAME,MAChBT,EAAUU,OAAS,IACrBL,EAAQ,WAMhB,IAAIM,EAAIV,EAEJW,EAAIT,EACJF,IACFU,EAAIA,EAAEE,MAAM,EAAG,IAEbV,IACFS,EAAIA,EAAEC,MAAM,EAAG,IAIjB,MAAO,2DAA2DhB,wJADnD,kCAAkCH,aAIcI,yDACpBC,GAAkBG,0FAErCE,EAASU,OAAO,EAAG,OAAOT,gGAG1BM,GAAKC,iGAOhCG,KAAK,IACR1C,EAAAgB,QAAQ2B,KAAK,SAAUvB,GACvBnB,EAAS2C,mBAAmB,YAAatB,M,sBCvF3C,MAAMuB,EAAY3C,SAASC,cAAc,wBACnC2C,EAAW5C,SAASC,cAAc,oBAClC4C,EAAY7C,SAASC,cAAc,cAYzC,SAAS6C,EAASC,GAChBC,QAAQC,IAAIF,GAEG,WAAXA,EAAEG,OACJL,EAAUM,UAAUC,IAAI,aACxBpD,SAASqD,oBAAoB,UAAWP,IAhB5CE,QAAQC,IAAIJ,GAEZF,EAAUW,iBAAiB,SAASP,IAClCA,EAAEQ,iBACFV,EAAUM,UAAUK,OAAO,aAC3BxD,SAASsD,iBAAiB,UAAWR,MAEvCF,EAASU,iBAAiB,SAASP,IACjCF,EAAUM,UAAUM,OAAO,gBAY7BZ,EAAUS,iBAAiB,SAE3B,SAAqBP,GACnB/C,SAASqD,oBAAoB,UAAWP,GACxCD,EAAUM,UAAUC,IAAI,gB,WC3B1B,IAAAM,EAAA7D,EAAA,S,aAKA,MAAM8D,EAAO,CACTC,eAAgB5D,SAASC,cAAc,4BACvC4D,WAAY7D,SAASC,cAAc,uBACnC6D,cAAe9D,SAASC,cAAc,8BAO1C,IAAI8D,EAUJ,SAASC,IACLC,EAAAC,YAAmBR,EAAAS,YAAYnC,MAC/BoC,IAGJ,SAASA,IACLT,EAAKE,WAAWV,UAAUK,OAAO,cAE0B,IAAvDG,EAAKE,WAAWV,UAAUnB,MAAMqC,SAAS,YACtCC,aAAaP,GAChBJ,EAAKC,eAAeP,oBAAoB,QAASW,GACjDL,EAAKG,cAAcT,oBAAoB,QAASe,IAxBpDT,EAAKC,eAAeN,iBAAiB,QAASU,GAC9CL,EAAKG,cAAcR,iBAAiB,QAASc,GAIrB,GAApBH,EAAAC,kBAAgDK,KAAZ,OAAXb,EAAAS,kBAAW,IAAXT,EAAAS,iBAAA,EAAAT,EAAAS,YAAanC,SAGtCoC,IACQL,EAAUS,YAAW,KAAQJ,MAAiB","sources":["src/index.js","src/js/loadPage.js","src/js/modalFooter.js","src/js/visitEvents.js"],"sourcesContent":["import './js/common';\nimport './js/fetchMovies';\nimport './js/arrowUp';\nimport './js/loadPage';\nimport './js/pageInStorage';\nimport './js/modal';\nimport './js/modalFooter';\nimport './js/storage';\nimport './js/visitEvents';\n\n","import storage from './storage';\nconst KEY = '659c146febfafc17fd54baa17527f7fa';\nconst homeList = document.querySelector('.home-list');\n\nconst API_URL_POPULAR = `https://api.themoviedb.org/3/trending/movie/week?api_key=${KEY}`;\n\nasync function fetchFilms(API_URL_POPULAR) {\n\n  let response = await fetch(\n    `${API_URL_POPULAR}`\n  );\n  return response.json();\n}\n\nasync function fetchGenres() {\n  let response = await fetch(\n    `https://api.themoviedb.org/3/genre/movie/list?api_key=${KEY}&language=en-US`\n  );\n  return response.json();\n}\n\nfetchGenres().then(({ genres }) => {\n  const arr = [...genres];\n  localStorage.setItem('arrow', JSON.stringify(arr));\n});\nconst values = storage.load('arrow');\n\n\n  fetchFilms(API_URL_POPULAR).then(({ results }) => {\n\n  results.poster_path;\n\n\n  const mark = results\n    .map(\n      ({\n        id,\n        poster_path,\n        title,\n        original_title,\n        genre_ids,\n        release_date,\n        original_name,\n        first_air_date,\n      }) => {\n        const genreArr = [];\n        let other = '';\n        for (const genreId of genre_ids) {\n          for (const value of values) {\n            if (genreId === value.id) {\n              genreArr.push(value.name);\n              if (genre_ids.length > 2) {\n                other = ',Other';\n              }\n            }\n          }\n        }\n\n        let a = release_date;\n\n        let b = first_air_date;\n        if (release_date) {\n          a = a.slice(0, 4);\n        }\n        if (first_air_date) {\n          b = b.slice(0, 4);\n        }\n\n        const imgUrl = `https://image.tmdb.org/t/p/w500${poster_path}`;\n        return `<li class=\"home-card js-modal-open\" data-card-movie-id=\"${id}\">\n            <a href=\"#\" class=\"home-card__link\">\n                <div class=\"card-info\">\n                    <img class=\"home-card__img\" src=\"${imgUrl}\" alt=\"${title}\">\n                    <h2 class=\"card-info__title\">${original_title || original_name}</h2>\n                    <p class=\"card-info_descr\">\n                        <span>${genreArr.splice(0, 3)}  ${other}</span>\n                        \n                        |\n                        <span>${a || b}</span>\n                    </p>\n                </div>\n            </a>\n        </li>`;\n      }\n    )\n    .join('');\n  storage.save('movies', results);\n  homeList.insertAdjacentHTML('beforeend', mark);\n});\n","const modalLink = document.querySelector('.footer__rights-link');\nconst closeBtn = document.querySelector('.modal__closeBtn');\nconst backDropp = document.querySelector('.backdropp');\nconsole.log(backDropp);\n\nmodalLink.addEventListener('click', e => {\n  e.preventDefault();\n  backDropp.classList.toggle('is-hidden');\n  document.addEventListener('keydown', pressEsc);\n});\ncloseBtn.addEventListener('click', e => {\n  backDropp.classList.remove('is-hidden');\n});\n\nfunction pressEsc(e) {\n  console.log(e);\n\n  if (e.code === 'Escape') {\n    backDropp.classList.add('is-hidden');\n    document.removeEventListener('keydown', pressEsc);\n  }\n}\n\nbackDropp.addEventListener('click', onBackdropp);\n\nfunction onBackdropp(e) {\n  document.removeEventListener('keydown', pressEsc);\n  backDropp.classList.add('is-hidden');\n}\n","import { storagePage } from './pageInStorage';\n// import { currentPage } from './pagination';\nimport * as page from './pagination';\n\n\nconst refs = {\n    comeBackButton: document.querySelector('button.js-visit-back-btn'),\n    visitModal: document.querySelector(\"[data-modal].dialog\"),   \n    visitCloseBtn: document.querySelector(\"button.js-visit-close-btn\"),\n};\n\n\n    refs.comeBackButton.addEventListener(\"click\", loadStoragePage);    \n    refs.visitCloseBtn.addEventListener(\"click\", toggleModal);\n    \nlet timerId;\n(() => {\n    if (page.currentPage == 1 || storagePage?.value === undefined) {\n        return \n    } else {        \n        toggleModal();\n        return  timerId = setTimeout(() => { toggleModal() }, 15000);      \n    }\n})();    \n\nfunction loadStoragePage() {     \n    page.currentPage = storagePage.value;\n    toggleModal();\n};\n\nfunction toggleModal() {   \n    refs.visitModal.classList.toggle(\"is-hidden\");     \n    \n    if (refs.visitModal.classList.value.includes(\"hidden\") === true) {\n           clearTimeout(timerId);  \n        refs.comeBackButton.removeEventListener(\"click\", loadStoragePage);        \n        refs.visitCloseBtn.removeEventListener(\"click\", toggleModal);\n    };\n};"],"names":["parcelRequire","$5uEKZ","$8a393290a593310b$var$homeList","document","querySelector","async","fetch","json","$8a393290a593310b$var$fetchGenres","then","genres","arr","localStorage","setItem","JSON","stringify","$8a393290a593310b$var$values","default","load","API_URL_POPULAR1","$8a393290a593310b$var$fetchFilms","results","poster_path","mark","map","id","title","original_title","genre_ids","release_date","original_name","first_air_date","genreArr","other","genreId","value","push","name","length","a","b","slice","splice","join","save","insertAdjacentHTML","$44332e2831bc6283$var$modalLink","$44332e2831bc6283$var$closeBtn","$44332e2831bc6283$var$backDropp","$44332e2831bc6283$var$pressEsc","e","console","log","code","classList","add","removeEventListener","addEventListener","preventDefault","toggle","remove","$ijW3m","$ffef372a5b1a0ba3$var$refs","comeBackButton","visitModal","visitCloseBtn","$ffef372a5b1a0ba3$var$timerId","$ffef372a5b1a0ba3$var$loadStoragePage","$2nhTy","currentPage","storagePage","$ffef372a5b1a0ba3$var$toggleModal","includes","clearTimeout","undefined","setTimeout"],"version":3,"file":"index.365ce0b1.js.map"}